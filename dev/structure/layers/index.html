<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Intermediate Representation · PNML.jl</title><meta name="title" content="Intermediate Representation · PNML.jl"/><meta property="og:title" content="Intermediate Representation · PNML.jl"/><meta property="twitter:title" content="Intermediate Representation · PNML.jl"/><meta name="description" content="Documentation for PNML.jl."/><meta property="og:description" content="Documentation for PNML.jl."/><meta property="twitter:description" content="Documentation for PNML.jl."/><meta property="og:url" content="https://strangehurst.github.io/PNML.jl/structure/layers/"/><meta property="twitter:url" content="https://strangehurst.github.io/PNML.jl/structure/layers/"/><link rel="canonical" href="https://strangehurst.github.io/PNML.jl/structure/layers/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PNML.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Petri Net Markup Language</a></li><li><a class="tocitem" href="../../status/">Status</a></li><li><span class="tocitem">Structure</span><ul><li class="is-active"><a class="tocitem" href>Intermediate Representation</a><ul class="internal"><li><a class="tocitem" href="#Core-Layer"><span>Core Layer</span></a></li><li><a class="tocitem" href="#Declaration-Dictionaries"><span>Declaration Dictionaries</span></a></li><li><a class="tocitem" href="#Net-Data-Dictionaries"><span>Net Data Dictionaries</span></a></li><li><a class="tocitem" href="#ID-Sets"><span>ID Sets</span></a></li><li><a class="tocitem" href="#Diagram-of-memory-footprint"><span>Diagram of memory footprint</span></a></li></ul></li><li><a class="tocitem" href="../pntd/">Petri Net Type Definition</a></li><li><a class="tocitem" href="../labels/">Labels</a></li><li><a class="tocitem" href="../traits/">Traits</a></li><li><a class="tocitem" href="../type_hierarchies/">Type Hierarchies</a></li><li><a class="tocitem" href="../interface/">Interfaces</a></li><li><a class="tocitem" href="../mathematics/">Math</a></li><li><a class="tocitem" href="../defaults/">Default Values</a></li><li><a class="tocitem" href="../parser/">Parser</a></li><li><a class="tocitem" href="../enabling_firing/">Enabling &amp; Firing Rules</a></li></ul></li><li><a class="tocitem" href="../../library/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Structure</a></li><li class="is-active"><a href>Intermediate Representation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Intermediate Representation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/strangehurst/PNML.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info" id="Graphics-are-elided-from-this-discussion-b3004a6c2696cd3d"><header class="admonition-header">Graphics are elided from this discussion<a class="admonition-anchor" href="#Graphics-are-elided-from-this-discussion-b3004a6c2696cd3d" title="Permalink"></a></header><div class="admonition-body"><p>Everywhere there are <code>ToolInfo</code>s in this discussion one may assume that there is also an optional <a href="../../library/#PNML.Labels.PnmlGraphics.Graphics"><code>Graphics</code></a> possible.</p><p>While we parse graphics XML into &quot;containers of strings&quot; and <a href="../../library/#PNML.Coordinate"><code>Coordinate</code></a>s no further use is implemented or planned. And no discussion of use is present.</p></div></div><h2 id="Core-Layer"><a class="docs-heading-anchor" href="#Core-Layer">Core Layer</a><a id="Core-Layer-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Layer" title="Permalink"></a></h2><p>An intermediate representation (IR) of the XML model usable to form networks. Many different flavors of Petri Nets are expected to be implemented using the IR.</p><p>XML attribute names and child element tag names are used as keys. The <em>pnml</em> standard/schemas do not use colliding names.</p><p>The core is implemented under the assumption the the input pnml file is valid. All tags are assumed to be meaningful to the resulting network. The pnmlcore schema requires undefined tags on objects will be considered pnml labels.</p><p>The IR is capable of handling arbitrary labels.</p><p>Many label tags from higherlevel pnml schemas are recognized by the IR core parser. They will be parsed for <code>pnmlcore</code> nets. Users are expected to use a meta-model if they want specific behavior.</p><p>Some parts of pnml are complicated.</p><p>The crude structure required by the pnmlcore schema:</p><p>PnmlModel</p><ul><li>Net<ul><li>Pages<ul><li>Places, Marking, Toolinfos, unclaimed labels  [SortType] [Capacity]</li><li>Transitions, Condition, Toolinfos, unclaimed labels [TransitionRate]</li><li>Arcs, Inscription, Toolinfos, unclaimed labels [ArcType]</li><li>Toolinfos [Labels.TokenGraphics]</li><li>Labels unclaimed, [Declaration]</li><li>Subpages</li></ul></li><li>Name Label</li><li>Toolinfos</li><li>Labels</li></ul></li></ul><p>This implementation will be a superset of what is in the standard.</p><p>Concepts from High-Level Petri Nets will be present in the Core layer.</p><h2 id="Declaration-Dictionaries"><a class="docs-heading-anchor" href="#Declaration-Dictionaries">Declaration Dictionaries</a><a id="Declaration-Dictionaries-1"></a><a class="docs-heading-anchor-permalink" href="#Declaration-Dictionaries" title="Permalink"></a></h2><p>The XML file format allows declarations to be declared in &lt;net&gt; and &lt;page&gt; elements.</p><p>All <a href="../../library/#PNML.Labels.Declaration"><code>Declaration</code></a> labels for a net share the same <code>DeclDict</code>. It is net-level data even when in a &lt;page&gt;.</p><p>XML XPath is used to gather this information before parsing the rest of the elements. Allows using <code>DeclDict</code> while parsing.</p><article><details class="docstring" open="true"><summary id="PNML.DeclDict-structure-layers"><a class="docstring-binding" href="#PNML.DeclDict-structure-layers"><code>PNML.DeclDict</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct DeclDict</code></pre><ul><li><code>variabledecls::Dict{Symbol, Any}</code>:     Holds <a href="../../library/#PNML.Declarations.VariableDeclaration"><code>VariableDeclaration</code></a>.     A <a href="../../library/#PNML.Variable"><code>Variable</code></a> is used to locate the declaration&#39;s name and sort.</li></ul><ul><li><p><code>namedsorts::Dict{Symbol, Any}</code></p></li><li><p><code>arbitrarysorts::Dict{Symbol, Any}</code></p></li><li><p><code>partitionsorts::Dict{Symbol, Any}</code></p></li><li><p><code>multisetsorts::Dict{Symbol, Any}</code></p></li><li><p><code>productsorts::Dict{Symbol, Any}</code></p></li><li><p><code>namedoperators::Dict{Symbol, Any}</code></p></li><li><p><code>arbitraryoperators::Dict{Symbol, Any}</code></p></li><li><p><code>partitionops::Dict{Symbol, Any}</code></p></li><li><p><code>feconstants::Dict{Symbol, Any}</code></p></li><li><p><code>useroperators::Dict{Symbol, Any}</code></p></li></ul><p>Collection of dictionaries holding various kinds of PNML declarations. Each keyed by REFID symbols.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/strangehurst/PNML.jl/blob/838f89faaae81a04964cb733a96bbc8cb8a39c26/src/Core/decldictcore.jl#L1-L8">source</a></section></details></article><h2 id="Net-Data-Dictionaries"><a class="docs-heading-anchor" href="#Net-Data-Dictionaries">Net Data Dictionaries</a><a id="Net-Data-Dictionaries-1"></a><a class="docs-heading-anchor-permalink" href="#Net-Data-Dictionaries" title="Permalink"></a></h2><p>This is where the graph node storage resides.</p><p><a href="../../library/#PNML.PnmlNetData"><code>PnmlNetData</code></a> contains ordered collections of the graph node objects, indexed by REFID symbols.</p><article><details class="docstring" open="true"><summary id="PNML.PnmlNetData-structure-layers"><a class="docstring-binding" href="#PNML.PnmlNetData-structure-layers"><code>PNML.PnmlNetData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct PnmlNetData</code></pre><ul><li><p><code>place_dict::OrderedCollections.OrderedDict{Symbol, Any}</code></p></li><li><p><code>transition_dict::OrderedCollections.OrderedDict{Symbol, Any}</code></p></li><li><p><code>arc_dict::OrderedCollections.OrderedDict{Symbol, Any}</code></p></li><li><p><code>refplace_dict::OrderedCollections.OrderedDict{Symbol, Any}</code></p></li><li><p><code>reftransition_dict::OrderedCollections.OrderedDict{Symbol, Any}</code></p></li></ul><p>Collect each of the <code>PnmlNodes</code>s &amp; <code>Arc</code>s of a Petri Net Graph into one collection. Accessed via pnml ID key or iterate over values of an <code>OrderedDict</code>.</p><p>In the &#39;pnml&#39; standard there is a <code>Page</code> structure that can be removed by <code>flatten_pages!</code>, removing some display-related information, leaving a functional Petri Net Graph as described in this structure. It is intended to be a per-<code>PnmlNet</code> database that is mutated as each page is parsed.</p><p>See <a href="../../library/#PNML.PnmlNetKeys"><code>PnmlNetKeys</code></a> for page-level pnml ID of &quot;owners&quot; net data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/strangehurst/PNML.jl/blob/838f89faaae81a04964cb733a96bbc8cb8a39c26/src/Core/pnmlnetdata.jl#L1">source</a></section></details></article><p>The XML file format distributes a &lt;net&gt; over one or more &lt;page&gt;s. As the pages are parsed, the nodes are appended to a <code>PnmlNetData</code> dictionary and a <code>PnmlNetKeys</code> set.</p><p>The <code>PnmlNetData</code> dictionaries maintain insertion order.</p><p>Each graph node may have labels attached. What labels depends on the <a href="../../library/#PNML.PnmlTypes"><code>PnmlTypes</code></a></p><h2 id="ID-Sets"><a class="docs-heading-anchor" href="#ID-Sets">ID Sets</a><a id="ID-Sets-1"></a><a class="docs-heading-anchor-permalink" href="#ID-Sets" title="Permalink"></a></h2><p><a href="../../library/#PNML.PnmlNetKeys"><code>PnmlNetKeys</code></a> contains ordered sets of REFID symbols.</p><article><details class="docstring" open="true"><summary id="PNML.PnmlNetKeys-structure-layers"><a class="docstring-binding" href="#PNML.PnmlNetKeys-structure-layers"><code>PNML.PnmlNetKeys</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct PnmlNetKeys</code></pre><ul><li><p><code>page_set::OrderedCollections.OrderedSet{Symbol}</code></p></li><li><p><code>place_set::OrderedCollections.OrderedSet{Symbol}</code></p></li><li><p><code>transition_set::OrderedCollections.OrderedSet{Symbol}</code></p></li><li><p><code>arc_set::OrderedCollections.OrderedSet{Symbol}</code></p></li><li><p><code>reftransition_set::OrderedCollections.OrderedSet{Symbol}</code></p></li><li><p><code>refplace_set::OrderedCollections.OrderedSet{Symbol}</code></p></li></ul><p>Per-page structure of <code>OrderedSet</code>s of pnml IDs for each &quot;owned&quot; <code>Page</code> and other <a href="../type_hierarchies/#AbstractPnmlObject"><code>AbstractPnmlObject</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/strangehurst/PNML.jl/blob/838f89faaae81a04964cb733a96bbc8cb8a39c26/src/Core/pnmlnetdata.jl#L79">source</a></section></details></article><p>Each <code>PnmlNetKeys</code> set maintains insertion order.</p><p>Uses REFIDs to keep track of which page owns which graph nodes or sub-page. We always use the <a href="../../library/#PNML.flatten_pages!"><code>flatten_pages!</code></a> version. Testing of non-flattened nets is very minimal.</p><div class="admonition is-warning" id="Warning-bedecf5e19478d76"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-bedecf5e19478d76" title="Permalink"></a></header><div class="admonition-body"><p>After <code>flatten_pages!</code> the <code>PnmlNetKeys</code> of the only remaining page are assumed to be the same as the <code>keys</code> of corresponding <code>PnmlNetData</code> dictionary.</p></div></div><h2 id="Diagram-of-memory-footprint"><a class="docs-heading-anchor" href="#Diagram-of-memory-footprint">Diagram of memory footprint</a><a id="Diagram-of-memory-footprint-1"></a><a class="docs-heading-anchor-permalink" href="#Diagram-of-memory-footprint" title="Permalink"></a></h2><p><img src="../data_layout.png" alt="alternative text"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../status/">« Status</a><a class="docs-footer-nextpage" href="../pntd/">Petri Net Type Definition »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 8 January 2026 18:15">Thursday 8 January 2026</span>. Using Julia version 1.13.0-alpha2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

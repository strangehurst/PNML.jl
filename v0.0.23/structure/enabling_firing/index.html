<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Enabling &amp; Firing Rules · PNML.jl</title><meta name="title" content="Enabling &amp; Firing Rules · PNML.jl"/><meta property="og:title" content="Enabling &amp; Firing Rules · PNML.jl"/><meta property="twitter:title" content="Enabling &amp; Firing Rules · PNML.jl"/><meta name="description" content="Documentation for PNML.jl."/><meta property="og:description" content="Documentation for PNML.jl."/><meta property="twitter:description" content="Documentation for PNML.jl."/><meta property="og:url" content="https://strangehurst.github.io/PNML.jl/structure/enabling_firing/"/><meta property="twitter:url" content="https://strangehurst.github.io/PNML.jl/structure/enabling_firing/"/><link rel="canonical" href="https://strangehurst.github.io/PNML.jl/structure/enabling_firing/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PNML.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Petri Net Markup Language</a></li><li><a class="tocitem" href="../../status/">Status</a></li><li><span class="tocitem">Structure</span><ul><li><a class="tocitem" href="../layers/">Intermediate Representation</a></li><li><a class="tocitem" href="../pntd/">Petri Net Type Definition</a></li><li><a class="tocitem" href="../labels/">Labels</a></li><li><a class="tocitem" href="../traits/">Traits</a></li><li><a class="tocitem" href="../type_hierarchies/">Type Hierarchies</a></li><li><a class="tocitem" href="../interface/">Interfaces</a></li><li><a class="tocitem" href="../mathematics/">Math</a></li><li><a class="tocitem" href="../defaults/">Default Values</a></li><li><a class="tocitem" href="../parser/">Parser</a></li><li class="is-active"><a class="tocitem" href>Enabling &amp; Firing Rules</a><ul class="internal"><li><a class="tocitem" href="#binding-value-set"><span>binding value set</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../library/">Docstrings</a></li><li><a class="tocitem" href="../../acknowledgments/">Acknowledgments</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Structure</a></li><li class="is-active"><a href>Enabling &amp; Firing Rules</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Enabling &amp; Firing Rules</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/strangehurst/PNML.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Enabling-and-Firing"><a class="docs-heading-anchor" href="#Enabling-and-Firing">Enabling and Firing</a><a id="Enabling-and-Firing-1"></a><a class="docs-heading-anchor-permalink" href="#Enabling-and-Firing" title="Permalink"></a></h1><p>See discussions on PnmlTuple, ProductSorts and variables.</p><p>This is a discussion of ENABLING rule</p><p><code>c::Condition</code> is attached to  <code>t::Transition</code>.</p><p><code>preset(net, pid(t)) ∪ postset(net, pid(t))</code> are the attached arcs.</p><p>arc inscription expressions have variable arguments as do conditions.</p><p>vars are ordered collections in standard! It uses Abstract Math and UML2 to say so. As they are the arguments to operators (expressions with variables), they need to be consistent.</p><p>0-ary operators are constants and literals (as ground terms without variables). Rewriting may? optimize/minimize these terms.</p><p>There will be inscriptions in preset(t) that are ground terms (constant or literal). Use in postset is the obvious case: generate token. A preset ground term inscription will not have a variable and use a <code>multiplicity = 1</code>. Value will be of the marking basis sort (like all inscriptions). The inscription is enabled if <code>multiset[value] &gt; 0</code>, and value is removed on firing. This is the same behavior as for PTNets that use integer-valued markings and inscriptions.</p><h2 id="binding-value-set"><a class="docs-heading-anchor" href="#binding-value-set">binding value set</a><a id="binding-value-set-1"></a><a class="docs-heading-anchor-permalink" href="#binding-value-set" title="Permalink"></a></h2><p>Collection of subsitution dictionaries created from binding value sets of all incriptions by selecting one from each set. <code>length(1st set) * length(2nd set) * ... length(nth set)</code></p><p>Condition     Each dictionary is one substitution for every variable     Dict(REFID =&gt; value in binding<em>value</em>set(REFID))</p><pre><code class="nohighlight hljs">sub = Dict{REFID,Ref{SORT}}()

Ref{SORT}(multiset element) || Ref{SORT}(multiset element, tuple index)
    REFID may be repeated
        multiple of same var in an inscrition &lt;= multplicity of a value in marking multiset
    &amp;/or
        same var in multiple inscriptions all with same value

for each substituion tuple element
    sub(varid) maps the variable to a value
    Used in evaluating (c::Condition)() to filter the substituion collection

for each preset(t) inscription
    bindings to marking values that satisfy the inscription.
    Only continue if all constraints are met, else return `false`.
    if var already has a binding only consider those values
        remove values from binding that do not satisfy this inscription
        value must be present in each marking of sufficent multiplicity
    #todo recursivly re-evaluate after each add?</code></pre><p><code>PnmlTuple</code> that are <code>ProductSort</code> elements and julia <code>Tuple</code> are not the same. ^ The vars tuple may contain elements of a PnmlTuple. Use marking basis to decide.</p><p>variables are how an element of marking multiset is identified/assessed.  for each preset(t)</p><ul><li>each element of each marking multiset is bound to the variable or variables  -&gt; tuple of bindings</li><li>enabling rule returning true for a tuple of bindings adds tuple to enabled transition modes.</li></ul><p>Generate JIT compiled code that uses REFID to update the VariableDeclaration  with arg reference information then applies/evaluates expression using the value.</p><p>? Each arg in iteratable ordered collection <code>args</code> is bound as the value of a ? pnml variable that appears within the expression tree rooted at <code>term</code>?</p><p>Varible in tree is a REFID to a VariableDeclaration that has the name and sort.  args are pairs of name (or REFID) and reference to marking value.</p><p>Reference to marking value is only read here as part of enabling function.</p><p>Make a copy of expression? Just during bring-up to verify same behavior &amp; debug.  Simplify the expression by rewriting once (not each use).  The optimized expression still has variables at this point that are REFIDs.</p><p>preset variables are a superset of postset variables.  Every postset variable is also a preset variable.</p><p>Variable v is bound to preset marking value (element of a multiset)</p><ul><li>as tuple of place REFID index into marking_vector, and a mutiset element.</li><li>bv_sets is a vector of variable binding value sets, one for each variable</li><li>use multipicity(multiset, element) &gt;= length(v in variables(inscription(arc))) to test enabled state of binding to an element</li><li>build a binding value set (bvs) of those element bindings that are enabled</li><li>each arc shares a bvs in bv_sets for each variable in variables(inscription(arc))</li><li>tr<em>vars records variables in transaction. There is a bv</em>sets for each REFID in tv_vars</li><li>one or more of the bvs members is selected for a firing</li><li></li></ul><p>Use variable to remove element (decrease multiplicity) from preset, add element to postset.</p><p>foreach preset(t) arc inscription vars tuple    enabling rule iterates matches for variable sort in marking multiset    testing each binding combination in condition functor.</p><p>Will iterate over each preset(t) marking&#39;s multiset elements.  There will be (must be) a variable for each sort in the multiset basis.  PnmlTuples are unpacked into multiple variables.</p><p>Variables that appear in more than one preset(t) marking basis  must have the same value in each marking to be enabled</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parser/">« Parser</a><a class="docs-footer-nextpage" href="../../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 29 August 2025 14:45">Friday 29 August 2025</span>. Using Julia version 1.12.0-rc1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
